<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/">

    <!-- Main Display Frame -->
    <Frame name="ProcEmFrame" parent="UIParent" movable="true" resizable="true" enableMouse="true" hidden="true">
        <Size>
            <AbsDimension x="250" y="300"/>
        </Size>
        <Anchors>
            <Anchor point="CENTER"/>
        </Anchors>
        <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
            <BackgroundInsets>
                <AbsInset left="11" right="12" top="12" bottom="11"/>
            </BackgroundInsets>
            <TileSize>
                <AbsValue val="32"/>
            </TileSize>
            <EdgeSize>
                <AbsValue val="32"/>
            </EdgeSize>
        </Backdrop>

        <!-- Resize Button -->
        <Button name="$parent_ResizeButton">
            <Size>
                <AbsDimension x="16" y="16"/>
            </Size>
            <Anchors>
                <Anchor point="BOTTOMRIGHT">
                    <Offset>
                        <AbsDimension x="-2" y="2"/>
                    </Offset>
                </Anchor>
            </Anchors>
            <Scripts>
                <OnMouseDown>
                    ProcEmFrame:StartSizing("BOTTOMRIGHT")
                </OnMouseDown>
                <OnMouseUp>
                    ProcEmFrame:StopMovingOrSizing()
                    ProcEmDB.displaySize = {ProcEmFrame:GetWidth(), ProcEmFrame:GetHeight()}
                </OnMouseUp>
            </Scripts>
            <NormalTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Up"/>
            <HighlightTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Highlight"/>
            <PushedTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Down"/>
        </Button>

        <Layers>
            <Layer level="ARTWORK">
                <!-- Title -->
                <FontString name="$parent_Title" inherits="GameFontNormalLarge" text="ProcEm - Session">
                    <Anchors>
                        <Anchor point="TOP" relativeTo="$parent">
                            <Offset>
                                <AbsDimension x="0" y="-15"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </FontString>

                <!-- Boss Name -->
                <FontString name="$parent_BossName" inherits="GameFontNormal" text="">
                    <Anchors>
                        <Anchor point="TOP" relativeTo="$parent_Title" relativePoint="BOTTOM">
                            <Offset>
                                <AbsDimension x="0" y="-5"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                    <Color r="1" g="0.5" b="0"/>
                </FontString>
            </Layer>
        </Layers>

        <!-- Scroll Frame for proc list -->
        <ScrollFrame name="$parent_ScrollFrame" inherits="FauxScrollFrameTemplate">
            <Size>
                <AbsDimension x="210" y="220"/>
            </Size>
            <Anchors>
                <Anchor point="TOP" relativeTo="$parent_BossName" relativePoint="BOTTOM">
                    <Offset>
                        <AbsDimension x="0" y="-10"/>
                    </Offset>
                </Anchor>
            </Anchors>
            <Scripts>
                <OnVerticalScroll>
                    FauxScrollFrame_OnVerticalScroll(16, function() ProcEm:UpdateDisplay() end)
                </OnVerticalScroll>
            </Scripts>
        </ScrollFrame>

        <!-- Close Button -->
        <Button name="$parent_CloseButton" inherits="UIPanelCloseButton">
            <Anchors>
                <Anchor point="TOPRIGHT">
                    <Offset>
                        <AbsDimension x="-5" y="-5"/>
                    </Offset>
                </Anchor>
            </Anchors>
        </Button>

        <!-- Reset Button -->
        <Button name="$parent_ResetButton" inherits="GameMenuButtonTemplate" text="Reset">
            <Size>
                <AbsDimension x="80" y="25"/>
            </Size>
            <Anchors>
                <Anchor point="BOTTOMLEFT">
                    <Offset>
                        <AbsDimension x="15" y="10"/>
                    </Offset>
                </Anchor>
            </Anchors>
            <Scripts>
                <OnClick>
                    ProcEm:InitSessionProcs()
                    ProcEm:UpdateDisplay()
                    ProcEm:Print("Session counters reset")
                </OnClick>
            </Scripts>
        </Button>

        <!-- Config Button -->
        <Button name="$parent_ConfigButton" inherits="GameMenuButtonTemplate" text="Config">
            <Size>
                <AbsDimension x="80" y="25"/>
            </Size>
            <Anchors>
                <Anchor point="BOTTOMRIGHT">
                    <Offset>
                        <AbsDimension x="-15" y="10"/>
                    </Offset>
                </Anchor>
            </Anchors>
            <Scripts>
                <OnClick>
                    if ProcEmConfigFrame then
                        ProcEmConfigFrame:Show()
                        ProcEm:RefreshConfigUI()
                    end
                </OnClick>
            </Scripts>
        </Button>

        <Scripts>
            <OnLoad>
                this:RegisterForDrag("LeftButton")
                this:SetMinResize(200, 150)
                this:SetMaxResize(600, 800)
            </OnLoad>
            <OnDragStart>
                if not ProcEmDB.displayLocked then
                    this:StartMoving()
                end
            </OnDragStart>
            <OnDragStop>
                this:StopMovingOrSizing()
                local point, _, relativePoint, xOfs, yOfs = this:GetPoint()
                ProcEmDB.displayPosition.point = point
                ProcEmDB.displayPosition.x = xOfs
                ProcEmDB.displayPosition.y = yOfs
            </OnDragStop>
            <OnShow>
                ProcEm:UpdateDisplay()
            </OnShow>
        </Scripts>
    </Frame>

    <!-- Configuration Frame -->
    <Frame name="ProcEmConfigFrame" parent="UIParent" movable="true" resizable="true" enableMouse="true" hidden="true">
        <Size>
            <AbsDimension x="320" y="450"/>
        </Size>
        <Anchors>
            <Anchor point="CENTER"/>
        </Anchors>
        <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
            <BackgroundInsets>
                <AbsInset left="11" right="12" top="12" bottom="11"/>
            </BackgroundInsets>
            <TileSize>
                <AbsValue val="32"/>
            </TileSize>
            <EdgeSize>
                <AbsValue val="32"/>
            </EdgeSize>
        </Backdrop>

        <!-- Resize Button -->
        <Button name="$parent_ResizeButton">
            <Size>
                <AbsDimension x="16" y="16"/>
            </Size>
            <Anchors>
                <Anchor point="BOTTOMRIGHT">
                    <Offset>
                        <AbsDimension x="-2" y="2"/>
                    </Offset>
                </Anchor>
            </Anchors>
            <Scripts>
                <OnMouseDown>
                    ProcEmConfigFrame:StartSizing("BOTTOMRIGHT")
                </OnMouseDown>
                <OnMouseUp>
                    ProcEmConfigFrame:StopMovingOrSizing()
                    ProcEmDB.configSize = {ProcEmConfigFrame:GetWidth(), ProcEmConfigFrame:GetHeight()}
                </OnMouseUp>
            </Scripts>
            <NormalTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Up"/>
            <HighlightTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Highlight"/>
            <PushedTexture file="Interface\ChatFrame\UI-ChatIM-SizeGrabber-Down"/>
        </Button>

        <Layers>
            <Layer level="ARTWORK">
                <!-- Title -->
                <FontString name="$parent_Title" inherits="GameFontNormalLarge" text="ProcEm Configuration">
                    <Anchors>
                        <Anchor point="TOP">
                            <Offset>
                                <AbsDimension x="0" y="-15"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
            </Layer>
        </Layers>

        <!-- Close Button -->
        <Button name="$parent_CloseButton" inherits="UIPanelCloseButton">
            <Anchors>
                <Anchor point="TOPRIGHT">
                    <Offset>
                        <AbsDimension x="-5" y="-5"/>
                    </Offset>
                </Anchor>
            </Anchors>
        </Button>

        <!-- Scroll Frame for proc checkboxes -->
        <ScrollFrame name="$parent_ScrollFrame" inherits="FauxScrollFrameTemplate">
            <Size>
                <AbsDimension x="280" y="310"/>
            </Size>
            <Anchors>
                <Anchor point="TOP" relativeTo="$parent_Title" relativePoint="BOTTOM">
                    <Offset>
                        <AbsDimension x="0" y="-20"/>
                    </Offset>
                </Anchor>
            </Anchors>
            <Scripts>
                <OnVerticalScroll>
                    FauxScrollFrame_OnVerticalScroll(20, function() ProcEm:RefreshConfigUI() end)
                </OnVerticalScroll>
            </Scripts>
        </ScrollFrame>

        <!-- Transparency Slider -->
        <Slider name="$parent_AlphaSlider" inherits="OptionsSliderTemplate">
            <Size>
                <AbsDimension x="180" y="16"/>
            </Size>
            <Anchors>
                <Anchor point="BOTTOM">
                    <Offset>
                        <AbsDimension x="0" y="35"/>
                    </Offset>
                </Anchor>
            </Anchors>
            <Scripts>
                <OnLoad>
                    getglobal(this:GetName().."Low"):SetText("0%")
                    getglobal(this:GetName().."High"):SetText("100%")
                    getglobal(this:GetName().."Text"):SetText("Transparency")
                    this:SetMinMaxValues(0, 100)
                    this:SetValueStep(5)
                </OnLoad>
                <OnValueChanged>
                    local alpha = arg1 / 100
                    ProcEmDB.displayAlpha = alpha
                    if ProcEmFrame then
                        ProcEmFrame:SetAlpha(alpha)
                    end
                    getglobal(this:GetName().."Text"):SetText("Transparency: " .. tostring(arg1) .. "%")
                </OnValueChanged>
            </Scripts>
        </Slider>

        <Scripts>
            <OnLoad>
                this:RegisterForDrag("LeftButton")
                this:SetMinResize(280, 350)
                this:SetMaxResize(600, 800)
            </OnLoad>
            <OnDragStart>
                this:StartMoving()
            </OnDragStart>
            <OnDragStop>
                this:StopMovingOrSizing()
            </OnDragStop>
        </Scripts>
    </Frame>

</Ui>
